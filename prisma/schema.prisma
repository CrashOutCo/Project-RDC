// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

/////////////////////////
// Project RDC Models   
// Player Ids      
// 1. Mark 
// 2. Aff
// 3. Des 
// 4. Ben
// 5. Lee
// 6. Dyl 
// 7. John 
// 8. Ippi 
//////////////////////

// {player_id: 1, player_name: "Mark", player_game_stats: []}
model Player {
  playerId        Int             @id @default(autoincrement()) @map("player_id")
  playerName      String          @map("player_name")
  sessions        SessionPlayer[]
  playerGameStats PlayerStat[]

  @@map("players")
}

//
// { game_id: 1, game_name: 'Mario Kart', game_stats: [], player_game_stats: [] }
model Game {
  gameId      Int          @id @default(autoincrement()) @map("game_id")
  gameName    String       @map("game_name")
  gameStats   GameStat[]
  playerStats PlayerStat[]

  @@map("games")
}

// { stat_id: 1, game_id: 1, stat_name: 'mk_first', stat_value: '0', date: 2024-10-23 12:00:00 }
model GameStat {
  statId          Int          @id @default(autoincrement()) @map("stat_id")
  gameId          Int          @map("game_id")
  statName        String       @map("stat_name")
  statValue       String       @map("stat_value")
  date            DateTime     @default(now()) // Date video posted
  game            Game         @relation(fields: [gameId], references: [gameId])
  playerGameStats PlayerStat[]

  @@map("game_stats")
}

// { player_game_stat_id: 1, player_id: 1, game_id: 1, stat_id: 1, value: }
model PlayerStat {
  playerStatId Int      @id @default(autoincrement()) @map("player_game_stat_id")
  playerId     Int      @map("player_id")
  player       Player   @relation(fields: [playerId], references: [playerId])
  gameId       Int      @map("game_id")
  game         Game     @relation(fields: [gameId], references: [gameId])
  gameStat     GameStat @relation(fields: [statId], references: [statId])
  statId       Int      @map("stat_id")
  sessionId    Int      @map("session_id")
  value        String
  datePlayed   DateTime @map("date_played")

  @@map("player_stats")
}

model Session {
  sessionId   Int             @id @default(autoincrement()) @map("session_id")
  sessionName String          @map("session_name")
  sessionUrl  String          @map("session_url")
  gameId      Int
  players     SessionPlayer[]

  // TODO: playerStats PlayerStat[]      @relation(fields: [sessionId], references: [sessionId])
  @@map("sessions")
}

// Join Table between Session & Player
model SessionPlayer {
  sessionPlayerId Int     @id @default(autoincrement()) @map("game_session_player_id")
  sessionId       Int     @map("session_id")
  session         Session @relation(fields: [sessionId], references: [sessionId])
  playerId        Int     @map("player_id")
  player          Player  @relation(fields: [playerId], references: [playerId])

  @@map("game_session_players")
}

// Set Table Conecpt 
// model Set { 
//   setId Int @id @default(autoincrement()) @map("set_id")
//   games Game[] @relation(fields: [gameId], references: [gameId])
//}
